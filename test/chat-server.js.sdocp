sdocp('test/chat-server.js.sdoc', 'A trivial chat server.\n\ncaterwaul.clone(\'std seq montenegro\')(function () {\n  caterwaul.montenegro.server(8080) /se[\n    // Server code:\n    let[clients = seq[~[]]] in\n    _.rpc(\'/chat\', fn_[clients.push(this)]).rpc(\'/chat/send\', fn[message][clients.each(fn[c][c(message)]), clients = seq[~[]], this(\'OK\')]),\n\n    // Client code:\n    _.html(\'/chat/app\', qs[caterwaul.montenegro.rpc(\'/chat\')(fn[message][$(\'.log\').append( html<< div.message(!(message /se[console.log(_)]))), this()]),\n                           let*[send = caterwaul.montenegro.rpc(\'/chat/send\')] in\n                           $(\'body\').append( html<< div.log(button(\'Send\') /click(fn_[send($(\'input\').val())]), input))])]})();\n');